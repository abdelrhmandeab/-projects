import numpy as np
from ml_model import ml_model
import logging

# Set up logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

def main():
    try:
        # Load features and labels
        X = np.load('features.npy')
        y = np.load('labels.npy')

        logger.info(f"Loaded {len(X)} samples with {X.shape[1]} features")

        # Train the model
        accuracy = ml_model.train_model(X, y)
        logger.info(f"Training completed. Cross-validation accuracy: {accuracy:.4f}")

    except Exception as e:
        logger.error(f"Error during training: {e}")

if __name__ == "__main__":
    main()